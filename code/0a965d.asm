0a965d    ae0005       ldx $0500
0a9660    9e6803       stz $0368,x
0a9663    9e6a03       stz $036a,x
0a9666    9e6c03       stz $036c,x
0a9669    9e7603       stz $0376,x
0a966c    e220         sep #$20
0a966e    9e7203       stz $0372,x
0a9671    9e7503       stz $0375,x
0a9674    a901         lda #$01
0a9676    9d7a03       sta $037a,x
0a9679    60           rts
0a967a    e220         sep #$20
0a967c    20b1d3       jsr $d3b1
0a967f    ae0005       ldx $0500
0a9682    202c80       jsr $802c
0a9685    b9b700       lda $00b7,y
0a9688    2984         and #$84
0a968a    f018         beq $0a96a4
0a968c    bd7203       lda $0372,x
0a968f    0920         ora #$20
0a9691    9d7203       sta $0372,x
0a9694    a902         lda #$02
0a9696    9d7503       sta $0375,x
0a9699    9e7603       stz $0376,x
0a969c    9e7703       stz $0377,x
0a969f    a902         lda #$02
0a96a1    9d7a03       sta $037a,x
0a96a4    60           rts
0a96a5    ae0005       ldx $0500
0a96a8    202c80       jsr $802c
0a96ab    b9b700       lda $00b7,y
0a96ae    298400       and #$0084
0a96b1    d010         bne $0a96c3
0a96b3    e220         sep #$20
0a96b5    bd7203       lda $0372,x
0a96b8    29df         and #$df
0a96ba    9d7203       sta $0372,x
0a96bd    a901         lda #$01
0a96bf    9d7a03       sta $037a,x
0a96c2    60           rts
0a96c3    e220         sep #$20
0a96c5    bd7503       lda $0375,x
0a96c8    f005         beq $0a96cf
0a96ca    de7503       dec $0375,x
0a96cd    d03f         bne $0a970e
0a96cf    c220         rep #$20
0a96d1    200080       jsr $8000
0a96d4    39b700       and $00b7,y
0a96d7    f035         beq $0a970e
0a96d9    9d7603       sta $0376,x
0a96dc    c90004       cmp #$0400
0a96df    9013         bcc $0a96f4
0a96e1    bd7303       lda $0373,x
0a96e4    29ff00       and #$00ff
0a96e7    4a           lsr a
0a96e8    4a           lsr a
0a96e9    4a           lsr a
0a96ea    4a           lsr a
0a96eb    1a           inc a
0a96ec    9d6803       sta $0368,x
0a96ef    9e6a03       stz $036a,x
0a96f2    8011         bra $0a9705
0a96f4    bd7403       lda $0374,x
0a96f7    29ff00       and #$00ff
0a96fa    4a           lsr a
0a96fb    4a           lsr a
0a96fc    4a           lsr a
0a96fd    4a           lsr a
0a96fe    1a           inc a
0a96ff    9d6a03       sta $036a,x
0a9702    9e6803       stz $0368,x
0a9705    9e6c03       stz $036c,x
0a9708    a90300       lda #$0003
0a970b    9d7a03       sta $037a,x
0a970e    60           rts
0a970f    ae0005       ldx $0500
0a9712    20478c       jsr $8c47
0a9715    b00b         bcs $0a9722
0a9717    bd6c03       lda $036c,x
0a971a    d018         bne $0a9734
0a971c    a90100       lda #$0001
0a971f    8d8609       sta $0986
0a9722    9e7603       stz $0376,x
0a9725    9e6803       stz $0368,x
0a9728    e220         sep #$20
0a972a    a902         lda #$02
0a972c    9d7503       sta $0375,x
0a972f    a902         lda #$02
0a9731    9d7a03       sta $037a,x
0a9734    60           rts
0a9735    e220         sep #$20
0a9737    ae0005       ldx $0500
0a973a    bdc003       lda $03c0,x
0a973d    d003         bne $0a9742
0a973f    9e7a03       stz $037a,x
0a9742    60           rts
0a9743    08           php
0a9744    c220         rep #$20
0a9746    ad6403       lda $0364
0a9749    f02f         beq $0a977a
0a974b    ad6603       lda $0366
0a974e    f02a         beq $0a977a
0a9750    a20000       ldx #$0000
0a9753    8e0005       stx $0500
0a9756    8e0405       stx $0504
0a9759    ad7c03       lda $037c
0a975c    3007         bmi $0a9765
0a975e    0a           asl a
0a975f    aa           tax
0a9760    fc7c97       jsr ($977c,x)
0a9763    c220         rep #$20
0a9765    a90200       lda #$0002
0a9768    8d0405       sta $0504
0a976b    ad7e03       lda $037e
0a976e    3005         bmi $0a9775
0a9770    0a           asl a
0a9771    aa           tax
0a9772    fc9097       jsr ($9790,x)
0a9775    e220         sep #$20
0a9777    2092c0       jsr $c092
0a977a    28           plp
0a977b    6b           rtl
